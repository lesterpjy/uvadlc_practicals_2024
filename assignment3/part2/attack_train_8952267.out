============================================================================================== 
Warning! Mixing Conda and module environments may lead to corruption of the
user environment. 
We do not recommend users mixing those two environments unless absolutely
necessary. Note that 
SURF does not provide any support for Conda environment.
For more information, please refer to our software policy page:
https://servicedesk.surf.nl/wiki/display/WIKI/Software+policy+Snellius#SoftwarepolicySnellius-UseofAnacondaandMinicondaenvironmentsonSnellius 

Remember that many packages have already been installed on the system and can
be loaded using 
the 'module load <package__name>' command. If you are uncertain if a package is
already available 
on the system, please use 'module avail' or 'module spider' to search for it.
============================================================================================== 
Arguments:
batch_size: 64
valid_ratio: 0.75
augmentations: False
pretrained: False
num_epochs: 30
train_strats: ['standard']
visualise: False
epsilon_fgsm: 0.1
alpha_fgsm: 0.5
epsilon_pgd: 0.01
alpha_pgd: 2
num_iter_pgd: 10
save_dir: 
test_crossover_defense: False
Device: cuda
training_strategy: standard
Loading model
Loading data
Files already downloaded and verified
Files already downloaded and verified
Training model
Epoch 0/29
----------
train Loss: 1.7285 Acc: 0.3704
val Loss: 1.4011 Acc: 0.4812
Epoch 1/29
----------
train Loss: 1.3061 Acc: 0.5289
val Loss: 1.1932 Acc: 0.5571
Epoch 2/29
----------
train Loss: 1.1031 Acc: 0.6058
val Loss: 1.0951 Acc: 0.5985
Epoch 3/29
----------
train Loss: 0.9493 Acc: 0.6653
val Loss: 1.0475 Acc: 0.6186
Epoch 4/29
----------
train Loss: 0.8078 Acc: 0.7187
val Loss: 0.9880 Acc: 0.6506
Epoch 5/29
----------
train Loss: 0.6752 Acc: 0.7693
val Loss: 0.9841 Acc: 0.6484
Epoch 6/29
----------
train Loss: 0.5443 Acc: 0.8161
val Loss: 1.0038 Acc: 0.6496
Epoch 7/29
----------
train Loss: 0.3587 Acc: 0.8972
val Loss: 0.9541 Acc: 0.6688
Epoch 8/29
----------
train Loss: 0.3251 Acc: 0.9104
val Loss: 0.9638 Acc: 0.6719
Epoch 9/29
----------
train Loss: 0.3014 Acc: 0.9200
val Loss: 0.9723 Acc: 0.6667
Epoch 10/29
----------
train Loss: 0.2849 Acc: 0.9267
val Loss: 0.9747 Acc: 0.6703
Epoch 11/29
----------
train Loss: 0.2692 Acc: 0.9322
val Loss: 0.9823 Acc: 0.6704
Epoch 12/29
----------
train Loss: 0.2573 Acc: 0.9354
val Loss: 0.9939 Acc: 0.6691
Epoch 13/29
----------
train Loss: 0.2412 Acc: 0.9412
val Loss: 0.9993 Acc: 0.6679
Epoch 14/29
----------
train Loss: 0.2236 Acc: 0.9488
val Loss: 1.0011 Acc: 0.6684
Epoch 15/29
----------
train Loss: 0.2211 Acc: 0.9495
val Loss: 0.9997 Acc: 0.6686
Epoch 16/29
----------
train Loss: 0.2179 Acc: 0.9520
val Loss: 0.9999 Acc: 0.6686
Epoch 17/29
----------
train Loss: 0.2206 Acc: 0.9489
val Loss: 1.0002 Acc: 0.6716
Epoch 18/29
----------
train Loss: 0.2146 Acc: 0.9519
val Loss: 1.0077 Acc: 0.6659
Epoch 19/29
----------
train Loss: 0.2141 Acc: 0.9527
val Loss: 1.0077 Acc: 0.6672
Epoch 20/29
----------
train Loss: 0.2145 Acc: 0.9524
val Loss: 1.0024 Acc: 0.6688
Epoch 21/29
----------
train Loss: 0.2126 Acc: 0.9526
val Loss: 1.0059 Acc: 0.6707
Epoch 22/29
----------
train Loss: 0.2118 Acc: 0.9532
val Loss: 1.0091 Acc: 0.6687
Epoch 23/29
----------
train Loss: 0.2130 Acc: 0.9530
val Loss: 1.0040 Acc: 0.6686
Epoch 24/29
----------
train Loss: 0.2100 Acc: 0.9541
val Loss: 1.0097 Acc: 0.6674
Epoch 25/29
----------
train Loss: 0.2126 Acc: 0.9522
val Loss: 1.0047 Acc: 0.6698
Epoch 26/29
----------
train Loss: 0.2111 Acc: 0.9522
val Loss: 1.0117 Acc: 0.6686
Epoch 27/29
----------
train Loss: 0.2115 Acc: 0.9530
val Loss: 1.0049 Acc: 0.6712
Epoch 28/29
----------
train Loss: 0.2112 Acc: 0.9533
val Loss: 1.0052 Acc: 0.6716
Epoch 29/29
----------
train Loss: 0.2093 Acc: 0.9544
val Loss: 1.0083 Acc: 0.6687
Training complete in 3m 42s
Best val Acc: 0.671875
Testing model
Accuracy of the network on the test set: 66 %
Testing adversarial attacks
Attack fgsm, args: {'alpha': 0.5, 'epsilon': 0.1}
Test Accuracy = 429 / 2500 = 0.1716
Attack pgd, args: {'alpha': 2, 'epsilon': 0.01, 'num_iter': 10}
Test Accuracy = 389 / 2500 = 0.1556
usage: train.py [-h] [--batch_size BATCH_SIZE] [--valid_ratio VALID_RATIO]
                [--augmentations] [--pretrained] [--num_epochs NUM_EPOCHS]
                [--train_strats {standard,fgsm,pgd} [{standard,fgsm,pgd} ...]]
                [--visualise] [--epsilon_fgsm EPSILON_FGSM]
                [--alpha_fgsm ALPHA_FGSM] [--epsilon_pgd EPSILON_PGD]
                [--alpha_pgd ALPHA_PGD] [--num_iter_pgd NUM_ITER_PGD]
                [--save_dir SAVE_DIR] [--test_crossover_defense]
train.py: error: argument --train_strats: invalid choice: 'FGSM' (choose from 'standard', 'fgsm', 'pgd')
srun: error: gcn17: task 0: Exited with exit code 2
srun: Terminating StepId=8952267.1
usage: train.py [-h] [--batch_size BATCH_SIZE] [--valid_ratio VALID_RATIO]
                [--augmentations] [--pretrained] [--num_epochs NUM_EPOCHS]
                [--train_strats {standard,fgsm,pgd} [{standard,fgsm,pgd} ...]]
                [--visualise] [--epsilon_fgsm EPSILON_FGSM]
                [--alpha_fgsm ALPHA_FGSM] [--epsilon_pgd EPSILON_PGD]
                [--alpha_pgd ALPHA_PGD] [--num_iter_pgd NUM_ITER_PGD]
                [--save_dir SAVE_DIR] [--test_crossover_defense]
train.py: error: argument --train_strats: invalid choice: 'PGD' (choose from 'standard', 'fgsm', 'pgd')
srun: error: gcn17: task 0: Exited with exit code 2
srun: Terminating StepId=8952267.2

JOB STATISTICS
==============
Job ID: 8952267
Cluster: snellius
User/Group: scur2818/scur2818
State: FAILED (exit code 2)
Nodes: 1
Cores per node: 18
CPU Utilized: 00:12:44
CPU Efficiency: 11.32% of 01:52:30 core-walltime
Job Wall-clock time: 00:06:15
Memory Utilized: 881.29 MB
Memory Efficiency: 2.75% of 31.25 GB
